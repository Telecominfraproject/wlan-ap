From 5d2f93353bbf240e3eff175322dd54f0f24154db Mon Sep 17 00:00:00 2001
From: Venkat Chimata <venkat@nearhop.com>
Date: Wed, 11 Feb 2026 09:57:54 +0530
Subject: [PATCH] ieee80211: ban clients based on the return value from
 hostapd_ubus_handle_event

Signed-off-by: Venkat Chimata <venkat@nearhop.com>
---
 src/ap/ieee802_11.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/ap/ieee802_11.c b/src/ap/ieee802_11.c
index ac6e8e4..d3cce33 100644
--- a/src/ap/ieee802_11.c
+++ b/src/ap/ieee802_11.c
@@ -3034,7 +3034,7 @@ static void handle_auth(struct hostapd_data *hapd,
 		goto fail;
 	}
 	ubus_resp = hostapd_ubus_handle_event(hapd, &req);
-	if (0 && ubus_resp) {
+	if (ubus_resp) {
 		wpa_printf(MSG_DEBUG, "Station " MACSTR " rejected by ubus handler.\n",
 			MAC2STR(mgmt->sa));
 		resp = ubus_resp > 0 ? (u16) ubus_resp : WLAN_STATUS_UNSPECIFIED_FAILURE;
@@ -5541,7 +5541,7 @@ static void handle_assoc(struct hostapd_data *hapd,
 #endif /* CONFIG_FILS */
 
 	ubus_resp = hostapd_ubus_handle_event(hapd, &req);
-	if (0 && ubus_resp) {
+	if (ubus_resp) {
 		wpa_printf(MSG_DEBUG, "Station " MACSTR " assoc rejected by ubus handler.\n",
 		       MAC2STR(mgmt->sa));
 		resp = ubus_resp > 0 ? (u16) ubus_resp : WLAN_STATUS_UNSPECIFIED_FAILURE;
-- 
2.34.1

