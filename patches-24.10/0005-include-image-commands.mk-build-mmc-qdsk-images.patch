From a1b87b05f966563829a9b14d1a64ee831e2f00a8 Mon Sep 17 00:00:00 2001
From: John Crispin <john@phrozen.org>
Date: Sun, 22 May 2022 16:56:10 +0200
Subject: [PATCH 05/55] include/image-commands.mk: build mmc qdsk images

Allows QSDK style factory image generation.

Signed-off-by: John Crispin <john@phrozen.org>
---
 include/image-commands.mk | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/include/image-commands.mk b/include/image-commands.mk
index a627ffc202..21d53877f1 100644
--- a/include/image-commands.mk
+++ b/include/image-commands.mk
@@ -601,6 +601,13 @@ define Build/qsdk-ipq-factory-nor
 	@mv $@.new $@
 endef
 
+define Build/qsdk-ipq-factory-mmc
+	$(TOPDIR)/scripts/mkits-qsdk-ipq-image.sh \
+		$@.its hlos $(IMAGE_KERNEL) rootfs $(IMAGE_ROOTFS)
+	PATH=$(LINUX_DIR)/scripts/dtc:$(PATH) mkimage -f $@.its $@.new
+	@mv $@.new $@
+endef
+
 define Build/seama
 	$(STAGING_DIR_HOST)/bin/seama -i $@ \
 		-m "dev=/dev/mtdblock/$(SEAMA_MTDBLOCK)" -m "type=firmware"
-- 
2.34.1

