From 91d881791574493beac9bcffc4cae9d2610be571 Mon Sep 17 00:00:00 2001
From: Venkat Chimata <venkat@nearhop.com>
Date: Wed, 11 Feb 2026 19:57:12 +0530
Subject: [PATCH] hostapd / ieee80211: ban clients based on the return value
 from  hostapd_ubus_handle_event

Signed-off-by: Venkat Chimata <venkat@nearhop.com>
---
 ...ients-based-on-the-return-value-from.patch | 36 +++++++++++++++++++
 1 file changed, 36 insertions(+)
 create mode 100644 package/network/services/hostapd/patches/zzzz-006-ieee80211-ban-clients-based-on-the-return-value-from.patch

diff --git a/package/network/services/hostapd/patches/zzzz-006-ieee80211-ban-clients-based-on-the-return-value-from.patch b/package/network/services/hostapd/patches/zzzz-006-ieee80211-ban-clients-based-on-the-return-value-from.patch
new file mode 100644
index 0000000000..6b8446ebda
--- /dev/null
+++ b/package/network/services/hostapd/patches/zzzz-006-ieee80211-ban-clients-based-on-the-return-value-from.patch
@@ -0,0 +1,36 @@
+From 5d2f93353bbf240e3eff175322dd54f0f24154db Mon Sep 17 00:00:00 2001
+From: Venkat Chimata <venkat@nearhop.com>
+Date: Wed, 11 Feb 2026 09:57:54 +0530
+Subject: [PATCH] ieee80211: ban clients based on the return value from
+ hostapd_ubus_handle_event
+
+Signed-off-by: Venkat Chimata <venkat@nearhop.com>
+---
+ src/ap/ieee802_11.c | 4 ++--
+ 1 file changed, 2 insertions(+), 2 deletions(-)
+
+diff --git a/src/ap/ieee802_11.c b/src/ap/ieee802_11.c
+index ac6e8e4..d3cce33 100644
+--- a/src/ap/ieee802_11.c
++++ b/src/ap/ieee802_11.c
+@@ -3034,7 +3034,7 @@ static void handle_auth(struct hostapd_data *hapd,
+ 		goto fail;
+ 	}
+ 	ubus_resp = hostapd_ubus_handle_event(hapd, &req);
+-	if (0 && ubus_resp) {
++	if (ubus_resp) {
+ 		wpa_printf(MSG_DEBUG, "Station " MACSTR " rejected by ubus handler.\n",
+ 			MAC2STR(mgmt->sa));
+ 		resp = ubus_resp > 0 ? (u16) ubus_resp : WLAN_STATUS_UNSPECIFIED_FAILURE;
+@@ -5541,7 +5541,7 @@ static void handle_assoc(struct hostapd_data *hapd,
+ #endif /* CONFIG_FILS */
+ 
+ 	ubus_resp = hostapd_ubus_handle_event(hapd, &req);
+-	if (0 && ubus_resp) {
++	if (ubus_resp) {
+ 		wpa_printf(MSG_DEBUG, "Station " MACSTR " assoc rejected by ubus handler.\n",
+ 		       MAC2STR(mgmt->sa));
+ 		resp = ubus_resp > 0 ? (u16) ubus_resp : WLAN_STATUS_UNSPECIFIED_FAILURE;
+-- 
+2.34.1
+
-- 
2.34.1

